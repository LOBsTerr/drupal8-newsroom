id: newsroom_topic
label: Newsroom topic
migration_group: newsroom

source:
  plugin: url
  data_fetcher_plugin: http
  data_parser_plugin: simple_xml
  urls: http://dc/stories.xml
  # http://ec.europa.eu/newsroom/dae/rss-service-multilingual.cfm?topic_id=15622
  #http://dc/stories.xml
  #http://ec.europa.eu/newsroom/dae/rss-service-multilingual.cfm
  #http://ec.europa.eu/newsroom/dae/rss-service-multilingual.cfm
  item_selector: '/rss/channel/item'
  # [infsonewsroom:BasicSvType="Newsroom service"]/category[@domain!="Newsletter"]
  #/ /  /category[@domain!="Newsletter"] infsonewsroom:BasicSvType1="Newsroom service" [infsonewsroom:BasicSvType1='Newsroom service1']

  ids:
    topic_id:
      type: integer

  fields:
    -
      name: topic_id
      label: Topic
      selector: '@nrid'
    -
      name: topic_name
      label: Name
      selector: 'text()'
    -
      name: parent_id
      label: Parent
      selector: '@infsonewsroom:parentTopicId'

process:
  vid:
    plugin: default_value
    default_value: newsroom_topic
  name: topic_name
  parent:
    plugin: migration_lookup
    migration: newsroom_topic
    source: parent_id
  field_newsroom_id: topic_id

destination:
  plugin: entity:taxonomy_term

dependencies:
  enforced:
    module:
      - nexteuropa_newsroom
